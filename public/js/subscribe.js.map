{"version":3,"sources":["subscribe.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"subscribe.js","sourcesContent":["new Vue({\n\n    /**\n     * Target element.\n     */\n    el: '#subscribe',\n\n    methods: {\n        subscribe: function() {\n\n            // Run validation functions\n            this.validateCardNumber();\n            this.validateExpiryDate();\n            this.validateCardCvc();\n\n            paymill.createToken({\n                number: this.$get('card_number'),\n                exp_month: this.$get('card_expiry_month'),\n                exp_year: this.$get('card_expiry_year'),\n                cvc: this.$get('card_cvc'),\n                cardholder: this.$get('card_holdername'),\n                amount: this.$get('amount'),\n                currency: this.$get('currency')\n            }, this.responseHandler);\n        },\n\n        responseHandler: function(error, result) {\n            // Handle error response\n            if (error) {\n                this.setApiErrorMessage(error.apierror);\n                return false;\n            }\n\n            // All is ok, send token to the server\n            var data = {\n                _token: Token.get(),\n                token: result.token\n            };\n            this.$http.post('/subscribe/process', data, function(response) {\n                //\n            }).error(function(response) {\n                //\n            });\n        },\n\n        /**\n         * Validate card number.\n         *\n         * @returns {boolean}\n         */\n        validateCardNumber: function() {\n            // Do nothing if card number is valid\n            if (paymill.validateCardNumber(this.$get('card_number'))) {\n                return true;\n            }\n\n            // Show error message if card number is invalid\n            this.$set('card_number_error', Translation.subscribe('card-number-error'));\n        },\n\n        /**\n         * Validate expiry date.\n         *\n         * @returns {boolean}\n         */\n        validateExpiryDate: function() {\n            // Do nothing if expiry date is valid\n            if (paymill.validateExpiry(this.$get('card_expiry_month'), this.$get('card_expiry_year'))) {\n                return true;\n            }\n\n            // Show error message if expiry date is invalid\n            this.$set('card_expiry_date_error', Translation.subscribe('card-expiry-date-error'));\n        },\n\n        /**\n         * Validate card cvc.\n         *\n         * @returns {boolean}\n         */\n        validateCardCvc: function() {\n            if (paymill.validateCvc(this.$get('card_cvc'))) {\n                return true;\n            }\n\n            // Show error if cvc is invalid\n            this.$set('card_cvc_error', Translation.subscribe('card-cvc-error'));\n        },\n\n        /**\n         * Return translated version of api error message.\n         *\n         * @param apiErrorMessage\n         */\n        setApiErrorMessage: function(apiErrorMessage) {\n\n            // All errors\n            var errors = {\n                internal_server_error: 'internal_server_error',\n                invalid_public_key: 'invalid_public_key',\n                unknown_error: 'unknown_error',\n                cancelled_3ds: '3ds_cancelled',\n                field_invalid_card_number: 'field_invalid_card_number',\n                field_invalid_card_exp_year: 'field_invalid_card_exp_year',\n                field_invalid_card_exp_month: 'field_invalid_card_exp_month',\n                field_invalid_card_exp: 'field_invalid_card_exp',\n                field_invalid_card_cvc: 'field_invalid_card_cvc',\n                field_invalid_card_holder: 'field_invalid_card_holder',\n                field_invalid_amount_int: 'field_invalid_amount_int',\n                field_invalid_amount: 'field_invalid_amount',\n                field_invalid_currency: 'field_invalid_currency'\n            };\n\n            switch (apiErrorMessage) {\n\n                // Internal server error\n                case errors.internal_server_error:\n                    this.set('general_error', Translation.subscribe('internal-server-error'));\n                    break;\n\n                // Invalid public key\n                case errors.invalid_public_key:\n                    this.set('general_error',  Translation.subscribe('internal-server-error'));\n                    break;\n\n                // Unknown error\n                case errors.unknown_error:\n                    this.$set('general_error', Translation.subscribe('internal-server-error'));\n                    break;\n\n                // 3ds cancelled\n                case errors.cancelled_3ds:\n                    this.$set('general_error', Translation.subscribe('payment-aborted'));\n                    break;\n\n                // Invalid card number\n                case errors.field_invalid_card_number:\n                    this.$set('card_number_error', Translation.subscribe('card-number-error'));\n                    break;\n\n                // Invalid card expiry year\n                case errors.field_invalid_card_exp_year:\n                    this.$set('card_expiry_date_error', Translation.subscribe('card-expiry-date-error'));\n                    break;\n\n                // Invalid card expiry month\n                case errors.field_invalid_card_exp_month:\n                    this.$set('card_expiry_date_error', Translation.subscribe('card-expiry-date-error'));\n                    break;\n\n                // Invalid card expiry date\n                case errors.field_invalid_card_exp:\n                    this.$set('card_expiry_date_error', Translation.subscribe('card-expiry-date-error'));\n                    break;\n\n                // Invalid card cvc\n                case errors.field_invalid_card_cvc:\n                    this.$set('card_cvc_error', Translation.subscribe('card-cvc-error'));\n                    break;\n\n                // Invalid card holder\n                case errors.field_invalid_card_holder:\n                    this.$set('card_holder_error', Translation.subscribe('card-holder-error'));\n                    break;\n\n                // Invalid amount for 3d secure\n                case errors.field_invalid_amount_int:\n                    this.$set('general_error', Translation.subscribe('internal-server-error'));\n                    break;\n\n                // Invalid amount\n                case errors.field_invalid_amount:\n                    this.$set('general_error', Translation.subscribe('internal-server-error'));\n                    break;\n\n                // Invalid currency\n                case errors.field_invalid_currency:\n                    this.$set('general_error', Translation.subscribe('internal-server-error'));\n                    break;\n            }\n        }\n    }\n\n});"],"sourceRoot":"/source/"}